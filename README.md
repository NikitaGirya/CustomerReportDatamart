# Витрина для клиентской отчетности

`postgresql`

---

Бизнесу требуется **витрина в PostgreSQL с данными**
* идентификатор записи
* идентификатор заказчика
* ФИО заказчика
* адрес заказчика
* дата рождения заказчика
* электронная почта заказчика
* сумма, которую потратил заказчик
* сумма, которую заработала платформа от покупок заказчика за месяц (10% от суммы, которую потратил заказчик)
* количество заказов у заказчика за месяц
* средняя стоимость одного заказа у заказчика за месяц
* медианное время в днях от момента создания заказа до его завершения за месяц
* самая популярная категория товаров у этого заказчика за месяц
* идентификатор самого популярного мастера ручной работы у заказчика. Если заказчик сделал одинаковое количество заказов у нескольких мастеров, возьмите любого
* количество созданных заказов за месяц
* количество заказов в процессе изготовки за месяц
* количество заказов в доставке за месяц
* количество завершённых заказов за месяц
* количество незавершённых заказов за месяц
* отчётный период, год и месяц

<br/>

**Скрипты**
1) `SQL_loading_from_sources.sql` - DML загрузки данных из источников в DWH
2) `DDL_customer_report_datamart.sql` - DDL витрины dwh.customer_report_datamart
3) `DDL_load_dates_customer_report_datamart.sql` - DDL таблицы инкрементальных загрузок dwh.load_dates_customer_report_datamart
4) `SQL_loading_customer_report_datamart.sql` - DML витрины dwh.customer_report_datamart

---

**Структура репозитория**

```
├── README.md
└── scripts
    ├── DDL_customer_report_datamart.sql
    ├── DDL_load_dates_customer_report_datamart.sql
    ├── SQL_loading_customer_report_datamart.sql
    └── SQL_loading_from_sources.sql
```
